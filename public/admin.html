<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
  <div class="w-full max-w-4xl bg-white p-8 rounded-lg shadow-lg">
    <h1 class="text-3xl font-bold mb-6 text-center">Admin Dashboard</h1>

    <!-- People Table -->
    <section class="mb-10">
      <h2 class="text-2xl font-semibold mb-4">Registered People</h2>
      <table class="min-w-full border border-gray-300">
        <thead>
          <tr class="bg-gray-200 text-left">
            <th class="px-4 py-2 border">ID</th>
            <th class="px-4 py-2 border">Name</th>
            <th class="px-4 py-2 border">Created At</th>
          </tr>
        </thead>
        <tbody id="people-table" class="divide-y divide-gray-200">
          <tr><td colspan="3" class="px-4 py-2 text-center text-gray-500">Loading...</td></tr>
        </tbody>
      </table>
    </section>

    <!-- Iterations Table -->
    <section>
      <h2 class="text-2xl font-semibold mb-4">Iterations</h2>
      <table class="min-w-full border border-gray-300">
        <thead>
          <tr class="bg-gray-200 text-left">
            <th class="px-4 py-2 border">ID</th>
            <th class="px-4 py-2 border">Name</th>
            <th class="px-4 py-2 border">Start Date</th>
            <th class="px-4 py-2 border">End Date</th>
            <th class="px-4 py-2 border">Question Set</th>
          </tr>
        </thead>
        <tbody id="iterations-table" class="divide-y divide-gray-200">
          <tr><td colspan="5" class="px-4 py-2 text-center text-gray-500">Loading...</td></tr>
        </tbody>
      </table>
    </section>
  </div>

<script>
  document.addEventListener('DOMContentLoaded', async () => {
    const iterationDisplay = document.getElementById('iteration-display');
    try {
      const response = await fetch('/api/active-iteration');
      const data = await response.json();

      if (!response.ok || !data.success || !data.iteration) {
        throw new Error(data.message || 'No active iteration found');
      }

      iterationDisplay.textContent =
        `Current Active Iteration: ${data.iteration.name} (ID: ${data.iteration.id})`;
    } catch (error) {
      iterationDisplay.textContent = `Error: ${error.message}`;
      iterationDisplay.classList.remove('text-blue-600');
      iterationDisplay.classList.add('text-red-600');
    }
  });
</script>

</body>
</html>

